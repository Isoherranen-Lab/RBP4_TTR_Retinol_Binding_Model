<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>combined_model</title>
<meta name="generator" content="MATLAB 24.1">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-06-21">
<meta name="DC.source" content="combined_model.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#1">MATLAB Code for Binding Model of RBP4, TTR, and Retinol</a>
</li>
<li>
<a href="#2">Inputs for model</a>
</li>
<li>
<a href="#3">Code implementation for all participants</a>
</li>
<li>
<a href="#4">results table</a>
</li>
<li>
<a href="#5">Sensitivity analysis varying TTR and Retinol concentrations</a>
</li>
<li>
<a href="#6">results table for sensitivity analysis</a>
</li>
<li>
<a href="#7">sensitivity analysis figures</a>
</li>
<li>
<a href="#8">define odes</a>
</li>
<li>
<a href="#9">define odes for sensitivity analysis</a>
</li>
<li>
<a href="#10">System of ODEs</a>
</li>
</ul>
</div>
<h2 id="1">MATLAB Code for Binding Model of RBP4, TTR, and Retinol</h2>
<pre class="codeinput">clear <span class="string">clc</span>
</pre>
<h2 id="2">Inputs for model</h2>
<p>define rate constants from literature Kds</p>
<pre class="codeinput">k1 = 10e8 ;  <span class="comment">% diffusion (M^-1 s^-1)</span>
k2 = 1.46e-7 * k1;  <span class="comment">% Kd of 178 nM from Muhilal and Glover 1975, 190 nM Cogan 1976, 70 nM from Noy 1992 (mean = 146 nM)</span>
k3 = 10e8 ;  <span class="comment">% diffusion (M^-1 s^-1)</span>
k4 = 2.82e-7  * k3;  <span class="comment">% alpha*Kd1 (mean 215 nM from 150 nM from Rostom 1998, 294 nM White and Kelly 2001, 200 nM Malpeli 1996)</span>
k5 = 10e8 ;  <span class="comment">% diffusion (M^-1 s^-1)</span>
k6 = 1.2e-6 * k5;  <span class="comment">% Kd2  1.2 uM from Malpeli 1996</span>
k7 = 10e8; <span class="comment">% diffusion (M-1 s-1)</span>
k8 = 3.44e-8; <span class="comment">% alpha*Kd2 (observed 35 nM Noy 1992)</span>

<span class="comment">% Time span for the simulation</span>
tspan = [0 1];  <span class="comment">%[inital:increment:end]</span>

<span class="comment">% Constrain solutions to be positive</span>
options = odeset(<span class="string">'MaxStep'</span>, 0.0001, <span class="string">'NonNegative'</span>, 1:6);
</pre>
<h2 id="3">Code implementation for all participants</h2>
<pre class="codeinput">
<span class="comment">% Import measured total concentrations for each particpiant</span>

<span class="comment">% Define the parameters for each participant with a table</span>
opts = spreadsheetImportOptions(<span class="string">"NumVariables"</span>, 4);
<span class="comment">% Specify sheet and range</span>
opts.Sheet = <span class="string">"Sheet1"</span>;
opts.DataRange = <span class="string">"A2:D32"</span>;
<span class="comment">% Specify column names and types</span>
opts.VariableNames = [<span class="string">"ParticipantID"</span>, <span class="string">"ROL_total"</span>, <span class="string">"RBP4_total"</span>, <span class="string">"TTR_total"</span>];
opts.VariableTypes = [<span class="string">"string"</span>, <span class="string">"double"</span>, <span class="string">"double"</span>, <span class="string">"double"</span>];
<span class="comment">% Specify variable properties</span>
opts = setvaropts(opts, <span class="string">"ParticipantID"</span>, <span class="string">"WhitespaceRule"</span>, <span class="string">"preserve"</span>);
opts = setvaropts(opts, <span class="string">"ParticipantID"</span>, <span class="string">"EmptyFieldRule"</span>, <span class="string">"auto"</span>);
<span class="comment">% Import the data</span>
participants = readtable(<span class="string">"C:\Users\isolab\UW\isolab - Aprajita Yadav\Manuscripts\Z_RBP4 TTR VAO Paper\Binding_model_git\VAOtable.xlsx"</span>, opts, <span class="string">"UseExcel"</span>, false);
clear <span class="string">opts</span>

<span class="comment">% Create an array for all the final results to go into</span>
ParticipantID = cell(height(participants), 1);
ROLu_end = zeros(height(participants), 1);
RBP4u_end = zeros(height(participants), 1);
TTRu_end = zeros(height(participants), 1);
aRBP4_TTR_end = zeros(height(participants), 1);
hRBP4_end = zeros(height(participants), 1);
hRBP4_TTR_end = zeros(height(participants), 1);
ROL_total_end = zeros(height(participants), 1);
RBP4_total_end = zeros(height(participants), 1);
TTR_total_end = zeros(height(participants), 1);

<span class="comment">% loop for all participants</span>
<span class="keyword">for</span> i = 1:height(participants)
    <span class="comment">% Extract participant data</span>
    ParticipantID{i} = participants.ParticipantID{i};  <span class="comment">% Participant ID</span>
    ROL_total = participants.ROL_total(i);  <span class="comment">% Total ROL for the participant</span>
    RBP4_total = participants.RBP4_total(i);  <span class="comment">% Total RBP4 for the participant</span>
    TTR_total = participants.TTR_total(i);  <span class="comment">% Total TTR for the participant</span>

    <span class="comment">% Initial conc (we assume nothing is complexed to start)</span>
    initial_hRBP4 = 0;
    initial_hRBP4_TTR = 0;
    initial_aRBP4_TTR = 0;
    initial_ROL_u = ROL_total - initial_hRBP4 - initial_hRBP4_TTR;
    initial_RBP4_u = RBP4_total - initial_hRBP4 - initial_hRBP4_TTR - initial_aRBP4_TTR;
    initial_TTR_u = TTR_total - initial_hRBP4_TTR - initial_aRBP4_TTR;
    initial_conditions = [initial_ROL_u, initial_RBP4_u, initial_hRBP4, initial_TTR_u, initial_hRBP4_TTR, initial_aRBP4_TTR];

    <span class="comment">%solve ode</span>
    [t, y] = ode89(@(t, y) odesystem(t, y, k1, k2, k3, k4, k5, k6, k7, k8), tspan, initial_conditions, options);

    <span class="comment">% Convert y-axis to micromolar (&micro;M) from molar (M)</span>
    y_um = y * 1e6;  <span class="comment">% Convert concentration to &micro;M</span>

    <span class="comment">%the following outputs the concentrations of all species at the end</span>
    ROLu_end(i) = y_um(end, 1);
    RBP4u_end(i) =  y_um(end, 2);
    aRBP4_TTR_end(i) =  y_um(end, 3);
    TTRu_end(i) = y_um(end, 4);
    hRBP4_end(i) = y_um(end, 5);
    hRBP4_TTR_end(i) = y_um(end, 6);
    ROL_total_end(i) = ROLu_end(i) + hRBP4_end(i) + hRBP4_TTR_end(i);
    RBP4_total_end(i) = RBP4u_end(i) + aRBP4_TTR_end(i) + hRBP4_end(i) + hRBP4_TTR_end(i);
    TTR_total_end(i) = TTRu_end(i) + aRBP4_TTR_end(i) + hRBP4_TTR_end(i);
<span class="keyword">end</span>

ParticipantID = cellstr(ParticipantID);
</pre>
<h2 id="4">results table</h2>
<p>Remove Percent sign to display and write results table to .csv</p>
<pre class="codeinput">results_table = table(ParticipantID, ROLu_end, RBP4u_end, TTRu_end, aRBP4_TTR_end, hRBP4_end, hRBP4_TTR_end, <span class="keyword">...</span>
    ROL_total_end, RBP4_total_end, TTR_total_end, <span class="keyword">...</span>
    <span class="string">'VariableNames'</span>, {<span class="string">'ParticipantID'</span>, <span class="string">'ROL_u (&micro;M)'</span>, <span class="string">'RBP4_u (&micro;M)'</span>, <span class="string">'TTR_u (&micro;M)'</span>, <span class="string">'RBP4:TTR (&micro;M)'</span>, <span class="string">'ROL:RBP4 (&micro;M)'</span>, <span class="keyword">...</span>
    <span class="string">'ROL:RBP4:TTR (&micro;M)'</span>, <span class="string">'ROL_total (&micro;M)'</span>, <span class="string">'RBP4_total (&micro;M)'</span>, <span class="string">'TTR_total (&micro;M)'</span>});
<span class="comment">% disp(results_table);</span>
<span class="comment">% filename='RBP4_TTR_Retinol_Binding.csv';</span>
<span class="comment">% writetable(results_table, filename);</span>
</pre>
<h2 id="5">Sensitivity analysis varying TTR and Retinol concentrations</h2>
<p>hold RBP4 constant at 2 &micro;M</p>
<pre class="codeinput">
<span class="comment">% ROL and TTR concentrations</span>
TTR_list = [2.5e-6:.25e-6:7.5e-6];
ROL_list = [1e-6:0.05e-6:2e-6];

<span class="comment">% empty array for results</span>
ROLu_end_s = zeros(length(TTR_list), 1);
RBP4u_end_s = zeros(length(TTR_list), 1);
TTRu_end_s = zeros(length(TTR_list), 1);
aRBP4_TTR_end_s = zeros(length(TTR_list), 1);
hRBP4_end_s = zeros(length(TTR_list), 1);
hRBP4_TTR_end_s = zeros(length(TTR_list), 1);
ROL_total_end_s = zeros(length(TTR_list), 1);
RBP4_total_end_s = zeros(length(TTR_list), 1);
TTR_total_end_s = zeros(length(TTR_list), 1);
Per_ROLu_end_s = zeros(length(TTR_list), 1);
Per_complex_end_s = zeros(length(TTR_list), 1);
Per_holo_end_s = zeros(length(TTR_list), 1);
Per_RBP4u_end_s = zeros(length(TTR_list), 1);
Per_hRBP4_end_s = zeros(length(TTR_list), 1);
Per_aRBP4TTR_end_s = zeros(length(TTR_list), 1);
Per_hRBP4_TTR_end_s = zeros(length(TTR_list), 1);

<span class="keyword">for</span> i = 1:length(TTR_list);
    TTR_total_s = TTR_list(i);
<span class="keyword">for</span>  j = 1:length(ROL_list);
     RBP4_total_s = 2e-6;
    ROL_total_s= ROL_list(j);

<span class="comment">% Initial conc (we assume nothing is complexed to start)</span>
 initial_hRBP4_s = 0;
 initial_hRBP4_TTR_s = 0;
 initial_aRBP4_TTR_s = 0;
 initial_ROL_u_s = ROL_total_s - initial_hRBP4_s - initial_hRBP4_TTR_s;
 initial_RBP4_u_s = RBP4_total_s - initial_hRBP4_s - initial_hRBP4_TTR_s - initial_aRBP4_TTR_s;
 initial_TTR_u_s = TTR_total_s - initial_hRBP4_TTR_s - initial_aRBP4_TTR_s;
 initial_conditions_s = [initial_ROL_u_s, initial_RBP4_u_s, initial_hRBP4_s, initial_TTR_u_s, initial_hRBP4_TTR_s, initial_aRBP4_TTR_s];

 <span class="comment">% solve odes</span>
 [t, y] = ode89(@(t, y) odesystem_s(t, y, k1, k2, k3, k4, k5, k6, k7, k8), tspan, initial_conditions_s, options);

 <span class="comment">% Convert y-axis to micromolar (&micro;M) from molar (M)</span>
  y_um = y * 1e6;  <span class="comment">% Convert concentration to &micro;M</span>

 <span class="comment">% the following outputs the concentrations of all species at the end</span>
    ROLu_end_s(j, i) = y_um(end, 1);
    RBP4u_end_s(j, i) =  y_um(end, 2);
    aRBP4_TTR_end_s(j, i) =  y_um(end, 3);
    TTRu_end_s(j, i) = y_um(end, 4);
    hRBP4_end_s(j, i) = y_um(end, 5);
    hRBP4_TTR_end_s(j, i) = y_um(end, 6);

 <span class="comment">% total concentrations</span>
    ROL_total_end_s(j, i) = ROLu_end_s(j, i) + hRBP4_end_s(j, i) + hRBP4_TTR_end_s(j, i);
    RBP4_total_end_s(j, i) = RBP4u_end_s(j, i) + aRBP4_TTR_end_s(j, i) + hRBP4_end_s(j, i) + hRBP4_TTR_end_s(j, i);
    TTR_total_end_s(j, i) = TTRu_end_s(j, i) + aRBP4_TTR_end_s(j, i) + hRBP4_TTR_end_s(j, i);

  <span class="comment">% calculate percentages</span>
  Per_ROLu_end_s(j, i) = (ROLu_end_s(j, i) / ROL_total_end_s(j, i))*100 ;
  Per_complex_end_s(j, i) = (hRBP4_TTR_end_s(j, i)/ROL_total_end_s(j, i))*100;
  Per_holo_end_s(j, i) = (hRBP4_end_s(j, i)/ROL_total_end_s(j, i))*100;
  Per_RBP4u_end_s(j, i) = (RBP4u_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_hRBP4_end_s(j, i) = (hRBP4_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_aRBP4TTR_end_s(j, i) = (aRBP4_TTR_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_hRBP4_TTR_end_s(j, i) = (hRBP4_TTR_end_s(j,i)/RBP4_total_end_s(j, i))*100;
<span class="keyword">end</span>
<span class="keyword">end</span>
</pre>
<h2 id="6">results table for sensitivity analysis</h2>
<pre class="codeinput">results_table_s = table(ROLu_end_s, RBP4u_end_s, TTRu_end_s, <span class="keyword">...</span>
    aRBP4_TTR_end_s, hRBP4_end_s, hRBP4_TTR_end_s, ROL_total_end_s, <span class="keyword">...</span>
    RBP4_total_end_s, TTR_total_end_s, Per_ROLu_end_s, Per_complex_end_s, <span class="keyword">...</span>
    Per_holo_end_s, Per_RBP4u_end_s, Per_hRBP4_end_s, Per_aRBP4TTR_end_s, <span class="keyword">...</span>
    Per_hRBP4_TTR_end_s, <span class="string">'VariableNames'</span>, {<span class="string">'ROL (&micro;M)'</span>, <span class="string">'RBP4 (&micro;M)'</span>, <span class="keyword">...</span>
    <span class="string">'TTR (&micro;M)'</span>, <span class="string">'RBP4:TTR (&micro;M)'</span>, <span class="string">'ROL:RBP4 (&micro;M)'</span>, <span class="string">'ROL:RBP4:TTR (&micro;M)'</span>, <span class="keyword">...</span>
    <span class="string">'ROL_total (&micro;M)'</span>, <span class="string">'RBP4_total (&micro;M)'</span>, <span class="string">'TTR_total (&micro;M)'</span>, <span class="keyword">...</span>
    <span class="string">'Percent Retinol unbound'</span>,<span class="string">'Percent ROL:RBP4:TTR'</span>, <span class="string">'Percent ROL:RBP4'</span>, <span class="keyword">...</span>
    <span class="string">'Percent apo-RBP4'</span>, <span class="string">'Percent holoRBP4'</span>, <span class="string">'Percent RBP4:TTR'</span>, <span class="keyword">...</span>
    <span class="string">'Percent complex RBP4'</span>});
<span class="comment">%disp(results_table); %remove percent sign to display results table</span>
</pre>
<h2 id="7">sensitivity analysis figures</h2>
<pre class="codeinput">screen_size = get(0, <span class="string">'ScreenSize'</span>);
fig_width = screen_size(3) /5;
fig_height = screen_size(4) / 3;

<span class="comment">% figure 3</span>
figure3 = figure(<span class="string">'Position'</span>, [0, screen_size(4)/4, fig_width, fig_height]);

axes3 = axes(<span class="string">'Parent'</span>, figure3);
hold(axes3, <span class="string">'on'</span>);

<span class="comment">% Create mesh</span>
mesh(ROL_total_end_s,TTR_total_end_s,RBP4u_end_s, <span class="string">'Parent'</span>,axes3);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_end_s, <span class="string">'Parent'</span>,axes3);
mesh(ROL_total_end_s,TTR_total_end_s,aRBP4_TTR_end_s, <span class="string">'Parent'</span>,axes3);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_TTR_end_s, <span class="string">'Parent'</span>,axes3);

<span class="comment">% Axis labels</span>
zlabel(axes3, {<span class="string">'RBP4 species (&micro;M)'</span>});
ylabel(axes3, {<span class="string">'TTR Tetramer (&micro;M)'</span>});
xlabel(axes3, {<span class="string">'Retinol (&micro;M)'</span>});

<span class="comment">% Viewing angle</span>
view(axes3,[-52.5 12.4]);
grid(axes3, <span class="string">'on'</span>);
set(axes3,<span class="string">'XTick'</span>,[1 1.25 1.5 1.75 2],<span class="string">'YTick'</span>,[2 4 6 8],<span class="string">'YTickLabel'</span>,<span class="keyword">...</span>
    {<span class="string">'2'</span>,<span class="string">'4'</span>,<span class="string">'6'</span>,<span class="string">'8'</span>},<span class="string">'ZTick'</span>, [0 0.5 1 1.5 2]);
axes3.XTickLabelRotation = 0;

<span class="comment">% Create textboxes</span>
annotation(figure3,<span class="string">'textbox'</span>,[0.15 0.32 0.19 0.06],<span class="string">'String'</span>,{<span class="string">'RBP4:TTR'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
annotation(figure3,<span class="string">'textbox'</span>,[0.15 0.26 0.14 0.06],<span class="string">'String'</span>,{<span class="string">'RBP4'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
annotation(figure3,<span class="string">'textbox'</span>,[0.64 0.33 0.26 0.06],<span class="string">'String'</span>,{<span class="string">'ROL:RBP4'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
annotation(figure3,<span class="string">'textbox'</span>,[0.15 0.77 0.64 0.06],<span class="string">'String'</span>,{<span class="string">'ROL:RBP4:TTR'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);

hold(axes3, <span class="string">'off'</span>)

<span class="comment">% figure 2</span>
figure2 = figure(<span class="string">'Position'</span>, [fig_width, screen_size(4)/4, fig_width, fig_height]); <span class="comment">% Position on the right side</span>

axes2 = axes(<span class="string">'Parent'</span>, figure2);
hold(axes2, <span class="string">'on'</span>);

<span class="comment">% Create mesh</span>
mesh(ROL_total_end_s,TTR_total_end_s,RBP4u_end_s, <span class="string">'Parent'</span>, axes2);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_end_s, <span class="string">'Parent'</span>, axes2);
mesh(ROL_total_end_s,TTR_total_end_s,aRBP4_TTR_end_s, <span class="string">'Parent'</span>, axes2);

<span class="comment">% Create axis labels</span>
zlabel(axes2, {<span class="string">'RBP4 species (&micro;M)'</span>});
ylabel(axes2, {<span class="string">'TTR Tetramer (&micro;M)'</span>});
xlabel(axes2, {<span class="string">'Retinol (&micro;M)'</span>});

<span class="comment">% Viewing angle</span>
view(axes2, [-52.5 12.4]);
grid(axes2, <span class="string">'on'</span>);
set(axes2,<span class="string">'XTick'</span>,[1 1.25 1.5 1.75 2], <span class="string">'YTick'</span>,[2 4 6 8],<span class="string">'YTickLabel'</span>,<span class="keyword">...</span>
    {<span class="string">'2'</span>,<span class="string">'4'</span>,<span class="string">'6'</span>,<span class="string">'8'</span>},<span class="string">'ZTick'</span>,[0 0.25 0.5 0.75 1]);
axes2.XTickLabelRotation = 0;

<span class="comment">% Create textboxes</span>
annotation(figure2,<span class="string">'textbox'</span>,[0.15 0.71 0.25 0.08],<span class="string">'String'</span>,{<span class="string">'RBP4:TTR'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
annotation(figure2,<span class="string">'textbox'</span>,[0.15 0.31 0.19 0.08],<span class="string">'String'</span>,{<span class="string">'RBP4'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);
annotation(figure2,<span class="string">'textbox'</span>,[0.69 0.46 0.26 0.08],<span class="string">'String'</span>,{<span class="string">'ROL:RBP4'</span>},<span class="string">'LineStyle'</span>,<span class="string">'none'</span>);

hold(axes2, <span class="string">'off'</span>)
</pre>
<h2 id="8">define odes</h2>
<pre class="codeinput">    <span class="keyword">function</span> dydt = odesystem(t, y, k1, k2, k3, k4, k5, k6, k7, k8)
    ROL_u = y(1);
    RBP4_u = y(2);
    aRBP4_TTR = y(3);
    TTR_u = y(4);
    hRBP4 = y(5);
    hRBP4_TTR = y(6);

    <span class="comment">% Differential equations</span>
    dROL_u = k2 * hRBP4 - k1 * ROL_u * RBP4_u +k8*hRBP4_TTR - k7*ROL_u*aRBP4_TTR;
    dRBP4_u = k2 * hRBP4 + k6 * aRBP4_TTR - k1 * ROL_u * RBP4_u - k5 * RBP4_u * TTR_u;
    daRBP4_TTR = k5 * RBP4_u * TTR_u - k6 * aRBP4_TTR - k7 * aRBP4_TTR * ROL_u + k8 * hRBP4_TTR;
    dTTR_u = k6 * aRBP4_TTR + k4 * hRBP4_TTR - k5 * RBP4_u * TTR_u - k3 * hRBP4 * TTR_u;
    dhRBP4 = k1 * ROL_u * RBP4_u + k4 * hRBP4_TTR - k2 * hRBP4 - k3 * hRBP4 * TTR_u;
    dhRBP4_TTR = k3 * hRBP4 * TTR_u - k4 * hRBP4_TTR - k8* hRBP4_TTR + k7* aRBP4_TTR * ROL_u;

    <span class="comment">% Results as vector</span>
    dydt = [dROL_u; dRBP4_u; daRBP4_TTR; dTTR_u; dhRBP4; dhRBP4_TTR];
    <span class="keyword">end</span>
</pre>
<h2 id="9">define odes for sensitivity analysis</h2>
<pre class="codeinput">    <span class="keyword">function</span> dydt = odesystem_s(t, y, k1, k2, k3, k4, k5, k6, k7, k8)
    ROL_u_s = y(1);
    RBP4_u_s = y(2);
    aRBP4_TTR_s = y(3);
    TTR_u_s = y(4);
    hRBP4_s = y(5);
    hRBP4_TTR_s = y(6);

    <span class="comment">% Differential equations</span>
    dROL_u_s = k2 * hRBP4_s - k1 * ROL_u_s * RBP4_u_s +k8*hRBP4_TTR_s - k7*ROL_u_s*aRBP4_TTR_s;
    dRBP4_u_s = k2 * hRBP4_s + k6 * aRBP4_TTR_s - k1 * ROL_u_s * RBP4_u_s - k5 * RBP4_u_s * TTR_u_s;
    daRBP4_TTR_s = k5 * RBP4_u_s * TTR_u_s - k6 * aRBP4_TTR_s - k7 * aRBP4_TTR_s * ROL_u_s + k8 * hRBP4_TTR_s;
    dTTR_u_s = k6 * aRBP4_TTR_s + k4 * hRBP4_TTR_s - k5 * RBP4_u_s * TTR_u_s - k3 * hRBP4_s * TTR_u_s;
    dhRBP4_s = k1 * ROL_u_s * RBP4_u_s + k4 * hRBP4_TTR_s - k2 * hRBP4_s - k3 * hRBP4_s * TTR_u_s;
    dhRBP4_TTR_s = k3 * hRBP4_s * TTR_u_s - k4 * hRBP4_TTR_s - k8* hRBP4_TTR_s + k7* aRBP4_TTR_s * ROL_u_s;

    <span class="comment">% Results as vector</span>
    dydt = [dROL_u_s; dRBP4_u_s; daRBP4_TTR_s; dTTR_u_s; dhRBP4_s; dhRBP4_TTR_s];
    <span class="keyword">end</span>
</pre>
<img vspace="5" hspace="5" src="combined_model_01.png" alt=""> <img vspace="5" hspace="5" src="combined_model_02.png" alt=""> <h2 id="10">System of ODEs</h2>
<pre class="codeinput">figure1=figure(<span class="string">'Color'</span>,<span class="string">'w'</span>, <span class="string">'Position'</span>, [100, 100, 1066, 700]);
axis <span class="string">off</span>
hold <span class="string">on</span>

y_start = 0.8;
dy = 0.1;
fs = 14;

<span class="comment">% Define each equation</span>
eqns = {
    <span class="string">'$$\frac{d\mathrm{ROL}}{dt} = k_2 \cdot \mathrm{ROL:RBP4} - k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} + k_8 \cdot \mathrm{ROL:RBP4:TTR} - k_7 \cdot \mathrm{ROL} \cdot \mathrm{RBP4:TTR}$$'</span>
    <span class="string">'$$\frac{d\mathrm{RBP4}}{dt} = k_2 \cdot \mathrm{ROL:RBP4} + k_6 \cdot \mathrm{RBP4:TTR} - k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} - k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR}$$'</span>
    <span class="string">'$$\frac{d\mathrm{RBP4:TTR}}{dt} = k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR} - k_6 \cdot \mathrm{RBP4:TTR} - k_7 \cdot \mathrm{RBP4:TTR} \cdot \mathrm{ROL} + k_8 \cdot \mathrm{ROL:RBP4:TTR}$$'</span>
    <span class="string">'$$\frac{d\mathrm{TTR}}{dt} = k_6 \cdot \mathrm{RBP4:TTR} + k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR} - k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR}$$'</span>
    <span class="string">'$$\frac{d\mathrm{ROL:RBP4}}{dt} = k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} + k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_2 \cdot \mathrm{ROL:RBP4} - k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR}$$'</span>
    <span class="string">'$$\frac{d\mathrm{ROL:RBP4:TTR}}{dt} = k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR} - k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_8 \cdot \mathrm{ROL:RBP4:TTR} + k_7 \cdot \mathrm{RBP4:TTR} \cdot \mathrm{ROL}$$'</span>
    };

<span class="comment">% Loop through and add each equation</span>
<span class="keyword">for</span> i = 1:length(eqns)
    text(0.01, y_start - (i-1)*dy, eqns{i}, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>, <span class="string">'FontSize'</span>, fs)
<span class="keyword">end</span>

<span class="comment">% Add a title at the top</span>
text(0.01, 0.9, <span class="string">'\textbf{Differential Equations for Retinol, RBP4, TTR Binding Model}'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>, <span class="string">'FontSize'</span>, fs+1)

hold <span class="string">off</span>
set(gca,<span class="string">'Position'</span>,[0 0 1 1])
</pre>
<img vspace="5" hspace="5" src="combined_model_03.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024a</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
%% MATLAB Code for Binding Model of RBP4, TTR, and Retinol 

clear clc

%% Inputs for model
% define rate constants from literature Kds
k1 = 10e8 ;  % diffusion (M^-1 s^-1)
k2 = 1.46e-7 * k1;  % Kd of 178 nM from Muhilal and Glover 1975, 190 nM Cogan 1976, 70 nM from Noy 1992 (mean = 146 nM)
k3 = 10e8 ;  % diffusion (M^-1 s^-1)
k4 = 2.82e-7  * k3;  % alpha*Kd1 (mean 215 nM from 150 nM from Rostom 1998, 294 nM White and Kelly 2001, 200 nM Malpeli 1996)
k5 = 10e8 ;  % diffusion (M^-1 s^-1)
k6 = 1.2e-6 * k5;  % Kd2  1.2 uM from Malpeli 1996
k7 = 10e8; % diffusion (M-1 s-1)
k8 = 3.44e-8; % alpha*Kd2 (observed 35 nM Noy 1992)

% Time span for the simulation
tspan = [0 1];  %[inital:increment:end]

% Constrain solutions to be positive
options = odeset('MaxStep', 0.0001, 'NonNegative', 1:6);

%% Code implementation for all participants

% Import measured total concentrations for each particpiant

% Define the parameters for each participant with a table
opts = spreadsheetImportOptions("NumVariables", 4);
% Specify sheet and range
opts.Sheet = "Sheet1";
opts.DataRange = "A2:D32";
% Specify column names and types
opts.VariableNames = ["ParticipantID", "ROL_total", "RBP4_total", "TTR_total"];
opts.VariableTypes = ["string", "double", "double", "double"];
% Specify variable properties
opts = setvaropts(opts, "ParticipantID", "WhitespaceRule", "preserve");
opts = setvaropts(opts, "ParticipantID", "EmptyFieldRule", "auto");
% Import the data
participants = readtable("C:\Users\isolab\UW\isolab - Aprajita Yadav\Manuscripts\Z_RBP4 TTR VAO Paper\Binding_model_git\VAOtable.xlsx", opts, "UseExcel", false);
clear opts

% Create an array for all the final results to go into
ParticipantID = cell(height(participants), 1);
ROLu_end = zeros(height(participants), 1);
RBP4u_end = zeros(height(participants), 1);
TTRu_end = zeros(height(participants), 1);
aRBP4_TTR_end = zeros(height(participants), 1);
hRBP4_end = zeros(height(participants), 1);
hRBP4_TTR_end = zeros(height(participants), 1);
ROL_total_end = zeros(height(participants), 1);
RBP4_total_end = zeros(height(participants), 1);
TTR_total_end = zeros(height(participants), 1);

% loop for all participants
for i = 1:height(participants)
    % Extract participant data
    ParticipantID{i} = participants.ParticipantID{i};  % Participant ID
    ROL_total = participants.ROL_total(i);  % Total ROL for the participant
    RBP4_total = participants.RBP4_total(i);  % Total RBP4 for the participant
    TTR_total = participants.TTR_total(i);  % Total TTR for the participant
    
    % Initial conc (we assume nothing is complexed to start)
    initial_hRBP4 = 0;
    initial_hRBP4_TTR = 0;
    initial_aRBP4_TTR = 0;
    initial_ROL_u = ROL_total - initial_hRBP4 - initial_hRBP4_TTR;  
    initial_RBP4_u = RBP4_total - initial_hRBP4 - initial_hRBP4_TTR - initial_aRBP4_TTR;  
    initial_TTR_u = TTR_total - initial_hRBP4_TTR - initial_aRBP4_TTR;
    initial_conditions = [initial_ROL_u, initial_RBP4_u, initial_hRBP4, initial_TTR_u, initial_hRBP4_TTR, initial_aRBP4_TTR];

    %solve ode
    [t, y] = ode89(@(t, y) odesystem(t, y, k1, k2, k3, k4, k5, k6, k7, k8), tspan, initial_conditions, options);

    % Convert y-axis to micromolar (µM) from molar (M)
    y_um = y * 1e6;  % Convert concentration to µM

    %the following outputs the concentrations of all species at the end
    ROLu_end(i) = y_um(end, 1);
    RBP4u_end(i) =  y_um(end, 2);
    aRBP4_TTR_end(i) =  y_um(end, 3);
    TTRu_end(i) = y_um(end, 4);
    hRBP4_end(i) = y_um(end, 5);
    hRBP4_TTR_end(i) = y_um(end, 6);
    ROL_total_end(i) = ROLu_end(i) + hRBP4_end(i) + hRBP4_TTR_end(i); 
    RBP4_total_end(i) = RBP4u_end(i) + aRBP4_TTR_end(i) + hRBP4_end(i) + hRBP4_TTR_end(i);
    TTR_total_end(i) = TTRu_end(i) + aRBP4_TTR_end(i) + hRBP4_TTR_end(i);
end

ParticipantID = cellstr(ParticipantID);

%% results table
% Remove Percent sign to display and write results table to .csv
results_table = table(ParticipantID, ROLu_end, RBP4u_end, TTRu_end, aRBP4_TTR_end, hRBP4_end, hRBP4_TTR_end, ...
    ROL_total_end, RBP4_total_end, TTR_total_end, ...
    'VariableNames', {'ParticipantID', 'ROL_u (µM)', 'RBP4_u (µM)', 'TTR_u (µM)', 'RBP4:TTR (µM)', 'ROL:RBP4 (µM)', ...
    'ROL:RBP4:TTR (µM)', 'ROL_total (µM)', 'RBP4_total (µM)', 'TTR_total (µM)'});
% disp(results_table); 
% filename='RBP4_TTR_Retinol_Binding.csv';
% writetable(results_table, filename);

%% Sensitivity analysis varying TTR and Retinol concentrations
% hold RBP4 constant at 2 µM

% ROL and TTR concentrations
TTR_list = [2.5e-6:.25e-6:7.5e-6];
ROL_list = [1e-6:0.05e-6:2e-6];

% empty array for results
ROLu_end_s = zeros(length(TTR_list), 1);
RBP4u_end_s = zeros(length(TTR_list), 1);
TTRu_end_s = zeros(length(TTR_list), 1);
aRBP4_TTR_end_s = zeros(length(TTR_list), 1);
hRBP4_end_s = zeros(length(TTR_list), 1);
hRBP4_TTR_end_s = zeros(length(TTR_list), 1);
ROL_total_end_s = zeros(length(TTR_list), 1);
RBP4_total_end_s = zeros(length(TTR_list), 1);
TTR_total_end_s = zeros(length(TTR_list), 1);
Per_ROLu_end_s = zeros(length(TTR_list), 1);
Per_complex_end_s = zeros(length(TTR_list), 1);
Per_holo_end_s = zeros(length(TTR_list), 1);
Per_RBP4u_end_s = zeros(length(TTR_list), 1);
Per_hRBP4_end_s = zeros(length(TTR_list), 1);
Per_aRBP4TTR_end_s = zeros(length(TTR_list), 1);
Per_hRBP4_TTR_end_s = zeros(length(TTR_list), 1);

for i = 1:length(TTR_list);
    TTR_total_s = TTR_list(i);  
for  j = 1:length(ROL_list);
     RBP4_total_s = 2e-6;
    ROL_total_s= ROL_list(j);
    
% Initial conc (we assume nothing is complexed to start)
 initial_hRBP4_s = 0;
 initial_hRBP4_TTR_s = 0;
 initial_aRBP4_TTR_s = 0;
 initial_ROL_u_s = ROL_total_s - initial_hRBP4_s - initial_hRBP4_TTR_s;  
 initial_RBP4_u_s = RBP4_total_s - initial_hRBP4_s - initial_hRBP4_TTR_s - initial_aRBP4_TTR_s;  
 initial_TTR_u_s = TTR_total_s - initial_hRBP4_TTR_s - initial_aRBP4_TTR_s;
 initial_conditions_s = [initial_ROL_u_s, initial_RBP4_u_s, initial_hRBP4_s, initial_TTR_u_s, initial_hRBP4_TTR_s, initial_aRBP4_TTR_s];

 % solve odes
 [t, y] = ode89(@(t, y) odesystem_s(t, y, k1, k2, k3, k4, k5, k6, k7, k8), tspan, initial_conditions_s, options);

 % Convert y-axis to micromolar (µM) from molar (M)
  y_um = y * 1e6;  % Convert concentration to µM

 % the following outputs the concentrations of all species at the end
    ROLu_end_s(j, i) = y_um(end, 1);
    RBP4u_end_s(j, i) =  y_um(end, 2);
    aRBP4_TTR_end_s(j, i) =  y_um(end, 3);
    TTRu_end_s(j, i) = y_um(end, 4);
    hRBP4_end_s(j, i) = y_um(end, 5);
    hRBP4_TTR_end_s(j, i) = y_um(end, 6);
    
 % total concentrations
    ROL_total_end_s(j, i) = ROLu_end_s(j, i) + hRBP4_end_s(j, i) + hRBP4_TTR_end_s(j, i); 
    RBP4_total_end_s(j, i) = RBP4u_end_s(j, i) + aRBP4_TTR_end_s(j, i) + hRBP4_end_s(j, i) + hRBP4_TTR_end_s(j, i);
    TTR_total_end_s(j, i) = TTRu_end_s(j, i) + aRBP4_TTR_end_s(j, i) + hRBP4_TTR_end_s(j, i);
    
  % calculate percentages
  Per_ROLu_end_s(j, i) = (ROLu_end_s(j, i) / ROL_total_end_s(j, i))*100 ;
  Per_complex_end_s(j, i) = (hRBP4_TTR_end_s(j, i)/ROL_total_end_s(j, i))*100;
  Per_holo_end_s(j, i) = (hRBP4_end_s(j, i)/ROL_total_end_s(j, i))*100;
  Per_RBP4u_end_s(j, i) = (RBP4u_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_hRBP4_end_s(j, i) = (hRBP4_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_aRBP4TTR_end_s(j, i) = (aRBP4_TTR_end_s(j,i) / RBP4_total_end_s(j,i))*100;
  Per_hRBP4_TTR_end_s(j, i) = (hRBP4_TTR_end_s(j,i)/RBP4_total_end_s(j, i))*100;
end
end

%% results table for sensitivity analysis
results_table_s = table(ROLu_end_s, RBP4u_end_s, TTRu_end_s, ...
    aRBP4_TTR_end_s, hRBP4_end_s, hRBP4_TTR_end_s, ROL_total_end_s, ...
    RBP4_total_end_s, TTR_total_end_s, Per_ROLu_end_s, Per_complex_end_s, ...
    Per_holo_end_s, Per_RBP4u_end_s, Per_hRBP4_end_s, Per_aRBP4TTR_end_s, ...
    Per_hRBP4_TTR_end_s, 'VariableNames', {'ROL (µM)', 'RBP4 (µM)', ...
    'TTR (µM)', 'RBP4:TTR (µM)', 'ROL:RBP4 (µM)', 'ROL:RBP4:TTR (µM)', ...
    'ROL_total (µM)', 'RBP4_total (µM)', 'TTR_total (µM)', ...
    'Percent Retinol unbound','Percent ROL:RBP4:TTR', 'Percent ROL:RBP4', ...
    'Percent apo-RBP4', 'Percent holoRBP4', 'Percent RBP4:TTR', ...
    'Percent complex RBP4'});
%disp(results_table); %remove percent sign to display results table

%% sensitivity analysis figures
screen_size = get(0, 'ScreenSize');
fig_width = screen_size(3) /5; 
fig_height = screen_size(4) / 3; 

% figure 3
figure3 = figure('Position', [0, screen_size(4)/4, fig_width, fig_height]); 

axes3 = axes('Parent', figure3);
hold(axes3, 'on');

% Create mesh
mesh(ROL_total_end_s,TTR_total_end_s,RBP4u_end_s, 'Parent',axes3);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_end_s, 'Parent',axes3);
mesh(ROL_total_end_s,TTR_total_end_s,aRBP4_TTR_end_s, 'Parent',axes3);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_TTR_end_s, 'Parent',axes3);

% Axis labels
zlabel(axes3, {'RBP4 species (µM)'});
ylabel(axes3, {'TTR Tetramer (µM)'});
xlabel(axes3, {'Retinol (µM)'});

% Viewing angle
view(axes3,[-52.5 12.4]);
grid(axes3, 'on');
set(axes3,'XTick',[1 1.25 1.5 1.75 2],'YTick',[2 4 6 8],'YTickLabel',...
    {'2','4','6','8'},'ZTick', [0 0.5 1 1.5 2]);
axes3.XTickLabelRotation = 0;

% Create textboxes
annotation(figure3,'textbox',[0.15 0.32 0.19 0.06],'String',{'RBP4:TTR'},'LineStyle','none');
annotation(figure3,'textbox',[0.15 0.26 0.14 0.06],'String',{'RBP4'},'LineStyle','none');
annotation(figure3,'textbox',[0.64 0.33 0.26 0.06],'String',{'ROL:RBP4'},'LineStyle','none');
annotation(figure3,'textbox',[0.15 0.77 0.64 0.06],'String',{'ROL:RBP4:TTR'},'LineStyle','none');

hold(axes3, 'off')

% figure 2
figure2 = figure('Position', [fig_width, screen_size(4)/4, fig_width, fig_height]); % Position on the right side

axes2 = axes('Parent', figure2);
hold(axes2, 'on');

% Create mesh
mesh(ROL_total_end_s,TTR_total_end_s,RBP4u_end_s, 'Parent', axes2);
mesh(ROL_total_end_s,TTR_total_end_s,hRBP4_end_s, 'Parent', axes2);
mesh(ROL_total_end_s,TTR_total_end_s,aRBP4_TTR_end_s, 'Parent', axes2);

% Create axis labels
zlabel(axes2, {'RBP4 species (µM)'});
ylabel(axes2, {'TTR Tetramer (µM)'});
xlabel(axes2, {'Retinol (µM)'});

% Viewing angle
view(axes2, [-52.5 12.4]);
grid(axes2, 'on');
set(axes2,'XTick',[1 1.25 1.5 1.75 2], 'YTick',[2 4 6 8],'YTickLabel',...
    {'2','4','6','8'},'ZTick',[0 0.25 0.5 0.75 1]);
axes2.XTickLabelRotation = 0;

% Create textboxes
annotation(figure2,'textbox',[0.15 0.71 0.25 0.08],'String',{'RBP4:TTR'},'LineStyle','none');
annotation(figure2,'textbox',[0.15 0.31 0.19 0.08],'String',{'RBP4'},'LineStyle','none');
annotation(figure2,'textbox',[0.69 0.46 0.26 0.08],'String',{'ROL:RBP4'},'LineStyle','none');

hold(axes2, 'off')

%% define odes
    function dydt = odesystem(t, y, k1, k2, k3, k4, k5, k6, k7, k8)
    ROL_u = y(1);
    RBP4_u = y(2);
    aRBP4_TTR = y(3);
    TTR_u = y(4);
    hRBP4 = y(5);
    hRBP4_TTR = y(6);
    
    % Differential equations
    dROL_u = k2 * hRBP4 - k1 * ROL_u * RBP4_u +k8*hRBP4_TTR - k7*ROL_u*aRBP4_TTR;
    dRBP4_u = k2 * hRBP4 + k6 * aRBP4_TTR - k1 * ROL_u * RBP4_u - k5 * RBP4_u * TTR_u;
    daRBP4_TTR = k5 * RBP4_u * TTR_u - k6 * aRBP4_TTR - k7 * aRBP4_TTR * ROL_u + k8 * hRBP4_TTR;
    dTTR_u = k6 * aRBP4_TTR + k4 * hRBP4_TTR - k5 * RBP4_u * TTR_u - k3 * hRBP4 * TTR_u;
    dhRBP4 = k1 * ROL_u * RBP4_u + k4 * hRBP4_TTR - k2 * hRBP4 - k3 * hRBP4 * TTR_u;
    dhRBP4_TTR = k3 * hRBP4 * TTR_u - k4 * hRBP4_TTR - k8* hRBP4_TTR + k7* aRBP4_TTR * ROL_u;

    % Results as vector
    dydt = [dROL_u; dRBP4_u; daRBP4_TTR; dTTR_u; dhRBP4; dhRBP4_TTR];
    end
%% define odes for sensitivity analysis
    function dydt = odesystem_s(t, y, k1, k2, k3, k4, k5, k6, k7, k8)
    ROL_u_s = y(1);
    RBP4_u_s = y(2);
    aRBP4_TTR_s = y(3);
    TTR_u_s = y(4);
    hRBP4_s = y(5);
    hRBP4_TTR_s = y(6);
    
    % Differential equations
    dROL_u_s = k2 * hRBP4_s - k1 * ROL_u_s * RBP4_u_s +k8*hRBP4_TTR_s - k7*ROL_u_s*aRBP4_TTR_s;
    dRBP4_u_s = k2 * hRBP4_s + k6 * aRBP4_TTR_s - k1 * ROL_u_s * RBP4_u_s - k5 * RBP4_u_s * TTR_u_s;
    daRBP4_TTR_s = k5 * RBP4_u_s * TTR_u_s - k6 * aRBP4_TTR_s - k7 * aRBP4_TTR_s * ROL_u_s + k8 * hRBP4_TTR_s;
    dTTR_u_s = k6 * aRBP4_TTR_s + k4 * hRBP4_TTR_s - k5 * RBP4_u_s * TTR_u_s - k3 * hRBP4_s * TTR_u_s;
    dhRBP4_s = k1 * ROL_u_s * RBP4_u_s + k4 * hRBP4_TTR_s - k2 * hRBP4_s - k3 * hRBP4_s * TTR_u_s;
    dhRBP4_TTR_s = k3 * hRBP4_s * TTR_u_s - k4 * hRBP4_TTR_s - k8* hRBP4_TTR_s + k7* aRBP4_TTR_s * ROL_u_s;

    % Results as vector
    dydt = [dROL_u_s; dRBP4_u_s; daRBP4_TTR_s; dTTR_u_s; dhRBP4_s; dhRBP4_TTR_s];
    end
%% System of ODEs
figure1=figure('Color','w', 'Position', [100, 100, 1066, 700]);
axis off 
hold on

y_start = 0.8; 
dy = 0.1;     
fs = 14;

% Define each equation
eqns = {
    '$$\frac{d\mathrm{ROL}}{dt} = k_2 \cdot \mathrm{ROL:RBP4} - k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} + k_8 \cdot \mathrm{ROL:RBP4:TTR} - k_7 \cdot \mathrm{ROL} \cdot \mathrm{RBP4:TTR}$$'
    '$$\frac{d\mathrm{RBP4}}{dt} = k_2 \cdot \mathrm{ROL:RBP4} + k_6 \cdot \mathrm{RBP4:TTR} - k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} - k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR}$$'
    '$$\frac{d\mathrm{RBP4:TTR}}{dt} = k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR} - k_6 \cdot \mathrm{RBP4:TTR} - k_7 \cdot \mathrm{RBP4:TTR} \cdot \mathrm{ROL} + k_8 \cdot \mathrm{ROL:RBP4:TTR}$$'
    '$$\frac{d\mathrm{TTR}}{dt} = k_6 \cdot \mathrm{RBP4:TTR} + k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_5 \cdot \mathrm{RBP4} \cdot \mathrm{TTR} - k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR}$$'
    '$$\frac{d\mathrm{ROL:RBP4}}{dt} = k_1 \cdot \mathrm{ROL} \cdot \mathrm{RBP4} + k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_2 \cdot \mathrm{ROL:RBP4} - k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR}$$'
    '$$\frac{d\mathrm{ROL:RBP4:TTR}}{dt} = k_3 \cdot \mathrm{ROL:RBP4} \cdot \mathrm{TTR} - k_4 \cdot \mathrm{ROL:RBP4:TTR} - k_8 \cdot \mathrm{ROL:RBP4:TTR} + k_7 \cdot \mathrm{RBP4:TTR} \cdot \mathrm{ROL}$$'
    };

% Loop through and add each equation
for i = 1:length(eqns)
    text(0.01, y_start - (i-1)*dy, eqns{i}, 'Interpreter', 'latex', 'FontSize', fs)
end

% Add a title at the top
text(0.01, 0.9, '\textbf{Differential Equations for Retinol, RBP4, TTR Binding Model}', 'Interpreter', 'latex', 'FontSize', fs+1)

hold off
set(gca,'Position',[0 0 1 1])

##### SOURCE END #####
-->
</body>
</html>
